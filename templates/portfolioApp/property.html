{% extends 'base.html'%}
        {% block title %}
          <title> {{property.name}} Property </title>
        {% endblock %}
        
        {% block search %}
        {% endblock %}
        
        {% block body %}
        <br><br><br>
        <div class="dropdown">
          <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
            Jul 22, 2023
            {% comment %} [] date variable {% endcomment %}
          </button>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Jul 22, 2023</a></li>
            <li><a class="dropdown-item" href="#">Jan 1, 2001 </a></li>
            <li><a class="dropdown-item" href="#">Something else here</a></li>
            {% comment %} {% for property in properties %}
              <li><a class="dropdown-item" href="#">{{property.flight_date}}</a></li>
            {% end for%} {% endcomment %}
          </ul>
        </div>
        <br><br><br><br><br><br>
        <div class="container mt-4">
            <div class="row">
                <div class="col-md-4 mb-3">
                  <button class="btn btn-link p-0" onclick="showContent('overflightContent')">
                      <img src={{flight.overflight_thumbnail_link}} style="width:24vw; height:auto; border-radius:2vw;" alt="Drone Flyover" class="img-fluid">
                  </button>
                  <br><br><br>
                  <h2>Overflight</h2>
                </div>
                <div class="col-md-4 mb-3">
                  <button class="btn btn-link p-0" onclick="showContent('exteriorModelContent')">
                      <img src={{flight.exterior_thumbnail_link}} style="width:24vw; height:auto; border-radius:2vw;" alt="Drone Flyover" class="img-fluid">
                  </button>
                  <br><br><br>
                  <h2>3D Exterior Model</h2>
                </div>
                <div class="col-md-4 mb-3">
                  <button class="btn btn-link p-0" onclick="showContent('interiorModelContent')">
                      <img src={{flight.interior_thumbnail_link}} style="width:24vw; height:auto; border-radius:2vw;" alt="Drone Flyover" class="img-fluid">
                  </button>
                  <br><br><br>
                  <h2>3D Interior Model</h2>
                </div>
            </div>
        </div>

        <div id="contentArea" class="container-fluid">
          <div id="overflightContent" class="content-section">
              <embed
              src="https://i.imgur.com/t1Tvutd.mp4"
              wmode="transparent"
              type="video/mp4"
              width="580" height="350"
              allow="autoplay; encrypted-media; picture-in-picture"
              allowfullscreen
              title="Sunrise Property"
            >
          </div>
          <div id="exteriorModelContent" class="content-section">
            <div id="exteriorModelContainer"></div>
          </div>
          <div id="interiorModelContent" class="content-section">
              <div id="interiorModelContainer"></div>
          </div>
      </div>


      {% comment %} exterior model {% endcomment %}
      <script type="module">
        import * as THREE from 'three';
        import WebGL from 'three/addons/capabilities/WebGL.js';
        import { FBXLoader } from 'three/addons/loaders/FBXLoader.js';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';

        let camera, scene, renderer, loader;
        let exteriorModelLoaded = false;
        let interiorModelLoaded = false;

        function initExteriorModel() {
            const container = document.getElementById('exteriorModelContainer');
            container.innerHTML = '';  // Clear previous content
        
            let camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 200000);
            camera.position.set(-7500, 10000, 5000);
        
            let scene = new THREE.Scene();
            let light = new THREE.AmbientLight(0x404040, 80);
            scene.add(light);
        
            let loader = new FBXLoader();
            loader.load('{{ flight.exterior_link }}', (object) => {
              scene.add(object);
            });
        
            let renderer = new THREE.WebGLRenderer();
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);
        
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.target.set(0, 1, 0);
            controls.update();
        
            window.addEventListener('resize', () => {
              camera.aspect = window.innerWidth / window.innerHeight;
              camera.updateProjectionMatrix();
              renderer.setSize(window.innerWidth, window.innerHeight);
            });
        
            function animate() {
              requestAnimationFrame(animate);
              renderer.render(scene, camera);
            }
        
            animate();  // Start the animation loop
          }
        
          function initInteriorModel() {
            const container = document.getElementById('interiorModelContainer');
            container.innerHTML = '';  // Clear previous content
        
            let camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 1, 200000);
            camera.position.set(-7500, 10000, 5000);
        
            let scene = new THREE.Scene();
            let light = new THREE.AmbientLight(0x404040, 80);
            scene.add(light);
        
            let loader = new FBXLoader();
            loader.load('{{ flight.interior_link }}', (object) => {
              scene.add(object);
            });
        
            let renderer = new THREE.WebGLRenderer();
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);
        
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.target.set(0, 1, 0);
            controls.update();
        
            window.addEventListener('resize', () => {
              camera.aspect = window.innerWidth / window.innerHeight;
              camera.updateProjectionMatrix();
              renderer.setSize(window.innerWidth, window.innerHeight);
            });
        
            function animate() {
              requestAnimationFrame(animate);
              renderer.render(scene, camera);
            }
        
            animate();  // Start the animation loop
          }
        
          function showContent(contentId) {
            document.querySelectorAll('.content-section').forEach(section => {
              section.classList.remove('show');
            });
        
            const selectedContent = document.getElementById(contentId);
            selectedContent.classList.add('show');
        
            // Load the correct model based on the content
            if (contentId === 'exteriorModelContent' && !exteriorModelLoaded) {
              initExteriorModel();  // Call the function to initialize exterior model
              exteriorModelLoaded = true;  // Set flag to avoid reloading the model
            } else if (contentId === 'interiorModelContent' && !interiorModelLoaded) {
              initInteriorModel();  // Call the function to initialize interior model
              interiorModelLoaded = true;  // Set flag to avoid reloading the model
            }
          }
        </script>

      {% endblock %}